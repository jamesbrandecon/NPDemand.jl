<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Post-Estimation · NPDemand</title><meta name="title" content="Post-Estimation · NPDemand"/><meta property="og:title" content="Post-Estimation · NPDemand"/><meta property="twitter:title" content="Post-Estimation · NPDemand"/><meta name="description" content="Documentation for NPDemand."/><meta property="og:description" content="Documentation for NPDemand."/><meta property="twitter:description" content="Documentation for NPDemand."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NPDemand</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">NPDemand.jl</a></li><li><span class="tocitem">Implementation Details</span><ul><li><a class="tocitem" href="../details/">Setup and GMM</a></li><li><a class="tocitem" href="../priors/">Quasibayes: Priors and Sampling</a></li><li><a class="tocitem" href="../constraints/">Constraints and SMC</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/">Basic Usage (GMM)</a></li><li><a class="tocitem" href="../quasibayes_usage/">Using Quasi-Bayes Tools</a></li></ul></li><li class="is-active"><a class="tocitem" href>Post-Estimation</a><ul class="internal"><li><a class="tocitem" href="#Estimated-Price-Elasticities"><span>Estimated Price Elasticities</span></a></li><li><a class="tocitem" href="#Estimated-Demand-Functions"><span>Estimated Demand Functions</span></a></li></ul></li><li><a class="tocitem" href="../functions/">Function Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Post-Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Post-Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jamesbrandecon/NPDemand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jamesbrandecon/NPDemand.jl/blob/master/docs/src/postestimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Post-Estimation"><a class="docs-heading-anchor" href="#Post-Estimation">Post-Estimation</a><a id="Post-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Post-Estimation" title="Permalink"></a></h1><h2 id="Estimated-Price-Elasticities"><a class="docs-heading-anchor" href="#Estimated-Price-Elasticities">Estimated Price Elasticities</a><a id="Estimated-Price-Elasticities-1"></a><a class="docs-heading-anchor-permalink" href="#Estimated-Price-Elasticities" title="Permalink"></a></h2><p>The main output that can be calculated from the results of <code>estimate!</code> is the full set of price elasticities of demand. Calculating all price elasticities requires  a single call to the <code>price_elasticities!</code> function. After this call, you can access the full set of elasticities via the field <code>npd_problem.all_elasticities</code>, which is an Array of matrices.  Each element of the array is the matrix of price elasticities for a market, where the <span>$(i,j)$</span> element of each matrix denotes the elasticity of demand for product <span>$i$</span> with respect to the price of product <span>$j$</span>. Alternatively, you can extract the own-price elasticities for each product using the <code>own_elasticities</code> function or summarize elasticities across markets using the <code>summarize_elasticities</code> function. Some example usage: </p><pre><code class="language-julia hljs">price_elasticities!(npd_problem); # Calculate all elasticities 

own = own_elasticities(npd_problem) # Extract own-price elasticities 

# Summaries of elasticities
summarize_elasticities(npd_problem, &quot;median&quot;)
summarize_elasticities(npd_problem, &quot;mean&quot;)
summarize_elasticities(npd_problem, &quot;quantile&quot;; q = 0.3) # 30th percentile</code></pre><h2 id="Estimated-Demand-Functions"><a class="docs-heading-anchor" href="#Estimated-Demand-Functions">Estimated Demand Functions</a><a id="Estimated-Demand-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Estimated-Demand-Functions" title="Permalink"></a></h2><p>One of the benefits of nonparametric demand estimation is that it can allow us to study the shape of the demand function and compare it to the demand functions implied by alternative models. For this purpose, or for evaluating the impact of counterfactual prices, it may be useful to estimate the demand function for a given set of prices of one good while keeping prices of other goods fixed, or at a vector of alternative prices. </p><p>This can be done using the <code>compute_demand_function!</code> function, which takes in a <code>NPDProblem</code> and a <code>DataFrame</code> which contains prices and market shares. The function then modifies the provided DataFrame, filling in the columns <code>shares0</code>, <code>shares1</code>, ..., <code>sharesJ</code> with the estimated shares for each market. This is a sightly more complicated task than in many structural models, because the parameters we are estimating govern the inverse demand system rather than the demand system itself. In order to calculate the (non-inverted) demand function, we have to perform a nonlinear search over market shares to match the user-provided prices and other index covariates. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><code>compute_demand_function!</code> can currently only calculate counterfacual market shares assuming that all demand shocks (<span>$\xi$</span>) are set to zero.  </p></div></div><p>Here is an example of how to use this function to compute the demand function, varying the price of product 1 while keeping prices of other goods fixed. </p><pre><code class="language-julia hljs"># Create a new DataFrame which can be filled in with estimated demand functions
alt_price_df = DataFrame(); # Initialize dataframe 
alt_price_df.prices1 = 1.1 .* ones(10); alt_price_df.prices2 .= 1.1; alt_price_df.prices3 .= 1.1;
alt_price_df.prices0 .= collect(range(0.7,1.3, length=10));
for j = 0:3
    alt_price_df[!,&quot;shares$j&quot;] .=0; # shares set to zero to initialize the fields-- compute_demand_function will ignore and replace these values
    alt_price_df[!,&quot;x$j&quot;] .= 0.5; 
end

compute_demand_function!(npd_problem, alt_price_df; max_iter = 1000, show_trace = false);</code></pre><p>As mentioned in the note above, if you run this code you will notice that the output above generates a warning that the function &quot;Assumes residual demand shifters set to zero.&quot; This refers to the values of the residuals <span>$\xi$</span>. Other alternative values for <span>$\xi$</span> will likely be implemented in future versions of the package. After running <code>compute_demand_function!</code>, we can then plot the estimated demand functions (stored in <code>shares0</code>...<code>shares3</code>). Here is some example code which plots all counterfactual shares: </p><pre><code class="language-julia hljs">plot(p, alt_price_df.prices0, alt_price_df.shares0, 
    color = :red, 
    lw = 1.5, label = &quot;Est. Share 1&quot;, 
    xlabel = &quot;Price 1&quot;, 
    ylabel = &quot;Market Share&quot;);
plot!(alt_price_df.prices0, alt_price_df.shares1, color = :grey, label = &quot;Est. Share 2&quot;);
plot!(alt_price_df.prices0, alt_price_df.shares2, color = :grey, label = &quot;Est. Share 3&quot;);
plot!(alt_price_df.prices0, alt_price_df.shares3, color = :grey, label = &quot;Est. Share 4&quot;);</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quasibayes_usage/">« Using Quasi-Bayes Tools</a><a class="docs-footer-nextpage" href="../functions/">Function Documentation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 10 January 2025 04:40">Friday 10 January 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
